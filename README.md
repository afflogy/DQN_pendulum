# ğŸ•¹ï¸DQN í•™ìŠµ - ë„ë¦½ì§„ìì˜ ì œì–´
: Pendulum System í™˜ê²½ì˜ DQNì„ í™œìš©í•œ ì œì–´ê¸° ê°•í™” í•™ìŠµ

## ğŸ§© Requirements
- gym
- pytorch

## ğŸ“ Reference Website
https://gymnasium.farama.org/environments/classic_control/pendulum/

## ğŸ§© Problem Solving Process
#### Cartpole systemì˜ DQNí•™ìŠµ ì½”ë“œì— ëŒ€í•œ ì´í•´

<img src=https://gymnasium.farama.org/_images/cart_pole.gif width="400" height="300"/>  <----- DQNí•™ìŠµì˜ CartPole

Cartpole Systemì€ poleì´ ìˆ˜ì§ìƒíƒœë¥¼ ìœ ì§€í•˜ë„ë¡ cartë¥¼ ë°€ê±°ë‚˜ ë‹¹ê²¨ì•¼ í•œë‹¤. ëª©í‘œëŠ” poleì„ ì“°ëŸ¬íŠ¸ë¦¬ì§€ ì•Šê³  ì˜¤ë˜ ìœ ì§€í•˜ëŠ” ê²ƒì´ë‹¤. OpenAI Gymì—ì„œ ì œê³µí•œ Cartpole ì˜ˆì œ ì½”ë“œëŠ” ì—ì´ì „íŠ¸ê°€ ìµœì ì˜ ì •ì±…ì„ í•™ìŠµí•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤. ì—ì´ì „íŠ¸ëŠ” í˜„ì¬ stateë¥¼ ê´€ì°°í•˜ê³  actionì„ ì„ íƒí•˜ë©°, ê·¸ì— ë”°ë¥¸ ë‹¤ìŒ ìƒíƒœì™€ ë³´ìƒì„ ë°›ëŠ”ë‹¤. ì´ ê³¼ì •ì„ ë°˜ë³µí•˜ë©° ë” ì¢‹ì€ ì •ì±…ì„ í•™ìŠµí•˜ê²Œ ëœë‹¤.


ì—¬ê¸°ì„œ ì‚¬ìš©ëœ DQN(Deep Q Nextwork)ì€ ë”¥ëŸ¬ë‹ê³¼ ê°•í™”í•™ìŠµì„ ê²°í•©í•œ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ë”¥ëŸ¬ë‹ ì‹ ê²½ë§ì„ ì‚¬ìš©í•˜ì—¬ ê°•í™”í•™ìŠµ ì—ì´ì „íŠ¸ë¥¼ í•™ìŠµì‹œí‚¤ê³ , ìµœì ì˜ í–‰ë™ì„ ê²°ì •í•˜ëŠ” Qí•¨ìˆ˜ë¥¼ ê·¼ì‚¬í•˜ëŠ” ë°©ì‹ì„ ê°€ì§„ë‹¤.


ğŸ”¹QëŸ¬ë‹ í•™ìŠµì— ì‚¬ìš©ë˜ëŠ” í–‰ë™ê°€ì¹˜í•¨ìˆ˜ Që¥¼ ê°œì„ í•˜ëŠ” ê³µì‹ : **Q(s,a)=Q(s,a)+Î±((r^'+Î³ã€–maxã€—_(a^' ) Q(s^',a^' ))-Q(s,a))**


DQNì´ì „ì— Qí•¨ìˆ˜ëŠ” ìƒíƒœ-í–‰ë™ ìŒìœ¼ë¡œ ì´ë£¨ì–´ì§„ ê°€ì¹˜í•¨ìˆ˜ë¡œ, í…Œì´ë¸” í™˜ê²½ì—ì„œ ìƒíƒœ-í–‰ë™ì— ëŒ€í•œ ê²°ê³¼ ì¤‘ ê°€ì¥ ìµœëŒ€ ê°’ì„ ê°€ì§€ëŠ” í–‰ë™ì„ ìµœì í–‰ë™ìœ¼ë¡œ ì„ íƒí•œë‹¤. ì´ëŸ¬í•œ Qí•¨ìˆ˜ ì¶”ì •ì„ ìœ„í•´ off-policy ì‹œê°„ì°¨ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì¸ QëŸ¬ë‹ì„ ì‚¬ìš©í•˜ëŠ”ë°...


ë‹¤ë§Œ, ì´ì „ì˜ í•™ìŠµê¹Œì§€ ì ìš©í–ˆë˜ í™˜ê²½ì€ ì œí•œì ì¸ ìƒíƒœì™€ í–‰ë™ì„ ê°€ì¡Œê¸° ë•Œë¬¸ì— ëª¨ë“  ìƒíƒœ-í–‰ë™ ìŒì„ ë¹„êµí–ˆë‹¤. í•˜ì§€ë§Œ, Cartpoleì˜ ê²½ìš°, ì…€ ìˆ˜ ì—†ëŠ” ìƒíƒœì™€ í–‰ë™ì´ ì¡´ì¬í•˜ëŠ” í™˜ê²½ì´ê¸° ë•Œë¬¸ì— ëª¨ë‘ ë¹„êµí•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥ì— ê°€ê¹ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— í•„ìš”í•œ ê²ƒì´ Qí•¨ìˆ˜ì˜ ê·¼ì‚¬í™”ì´ë‹¤. ê°€ì¤‘ì¹˜ê°€ ì¡´ì¬í•˜ëŠ” ì‹ ê²½ë§(Î¸)ì„ ì‚¬ìš©í•´ì„œ ê° ìƒíƒœì—ì„œ ëª¨ë“  ì‘ì—…ì— ëŒ€í•œ Qê°’ì„ ê·¼ì‚¬í™” í•  ìˆ˜ ìˆë‹¤.


ê·¸ëŸ¬ë¯€ë¡œ, Që„¤íŠ¸ì›Œí¬ì—ì„œ ì‹ ê²½ë§ì„ í†µí•´ Qí•¨ìˆ˜ë¥¼ ê·¼ì‚¬í™” í•˜ëŠ” ê²ƒì€ ì†ì‹¤í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ì—¬ Q-valueì˜ ëª©í‘œ ê°’ê³¼ ì˜ˆì¸¡ ê°’ ì‚¬ì´ì˜ ì°¨ì´ë¥¼ ê°€ì¤‘ì¹˜ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ê²½ì‚¬ í•˜ê°•ë²•ì„ í†µí•´ ìµœì†Œí™”í•œë‹¤. 

## ğŸ§© DQN Pendulum design process
<img src=https://gymnasium.farama.org/_images/pendulum.gif width="300" height="300"/>  <----- DQNí•™ìŠµìœ¼ë¡œ Pendulumì„ ìœ„ë¡œ ê³ ì •í•´ì•¼í•œë‹¤.

Pendulum ì´ì‚°ì ì´ì§€ ì•Šë‹¤. ìƒíƒœ ê³µê°„ì€ 3ì°¨ì›ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ì´ 3ì°¨ì›ì€ ê°ë„, ê°ì†ë„, ê·¸ë¦¬ê³  ì§„ìì˜ ëì  ìœ„ì¹˜ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. í–‰ë™ ê³µê°„ì€ ì—°ì†ì ìœ¼ë¡œ [-2,2]ì‚¬ì´ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ DQNì€ cartpoleê°™ì€ ì´ì‚°ì  í–‰ë™ ê³µê°„ì— ì í•©í•˜ë‹¤. Pendulum ê³µê°„ì„ ì´ì‚°ì  í–‰ë™ ê³µê°„ìœ¼ë¡œ ë³€í™˜í•´ì•¼ í•œë‹¤.
ê·¸ë¦¬ê³  e-greedyì •ì±…ì„ ì‚¬ìš©í•´ì„œ í•™ìŠµëœ ì •ì±…ì„ ë” ë§ì´ í™œìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼ í•œë‹¤. (í•™ìŠµì´ ì§„í–‰ë¨ì— ë”°ë¼ì„œ ì—¡ì‹¤ë¡ ì˜ ê°’ì„ ì¤„ì—¬ê°€ë©´ì„œ íƒìƒ‰ì˜ ë¹„ìœ¨ì„ ì¤„ì¸ë‹¤.)

(1) ê¸°ë³¸ì ì¸ ë§¤ê°œë³€ìˆ˜ë¥¼ ì„¤ì • : í•™ìŠµë¥ , í• ì¸ë¥ , ì—¡ì‹¤ë¡ ì˜ ê°ì†Œìœ¨, ë©”ëª¨ë¦¬ ì‚¬ì´ì¦ˆ..
(2) Që„¤íŠ¸ì›Œí¬ í•¨ìˆ˜ ì„¤ê³„(Qnetwork) : ê¸°ì¡´ ë”¥ëŸ¬ë‹ì—ì„œ ì“°ì´ëŠ” ì¸ê³µì‹ ê²½ë§ê³¼ ê°™ì€ êµ¬ì¡°
(3) Agent êµ¬í˜„ : Që„¤íŠ¸ì›Œí¬ í•™ìŠµì˜ ê³¼ì •ì¸ sampleìƒì„±, íƒ€ê²Ÿ ëª¨ë¸ ì—…ë°ì´íŠ¸ ë“± 
(4) DQN í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ : ë¦¬í”Œë ˆì´ ë©”ëª¨ë¦¬ ì €ì¥

## ğŸ§© Result
